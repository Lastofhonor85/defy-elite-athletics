<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drills Library – Members</title>
  <link rel="stylesheet" href="../styles.css" />
</head>
<body class="dark">
  <!-- SITE HEADER -->
  <header class="site-header">
    <a href="articles.html">
      <img
        src="../assets/logo1.webp"
        alt="Defy Elite Athletics"
        class="logo"
        loading="lazy"
      />
    </a>
  </header>

  <!-- NAVIGATION BAR -->
  <nav class="main-nav">
    <a href="dashboard.html">Dashboard</a>
    <a href="drills.html" style="color: #09f; font-weight: bold;">Drills</a>
    <a href="exercises.html">Exercises</a>
    <a href="articles.html">Articles</a>
    <a href="resources.html">Coaching &amp; Resources</a>
    <a href="nutrition.html">Nutrition</a>
    <a href="logout.html">Logout</a>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="container">
    <h1 class="section-title">Drills Library</h1>
    <p class="text-lead">
      Browse and search the complete drills database. Click a column header to sort, or use the search box to filter.
    </p>

    <!-- Search input -->
    <input
      type="search"
      id="drill-search"
      placeholder="Search drills..."
      style="width: 100%; padding: 0.5rem; font-size: 1rem; margin-bottom: 1rem; border-radius: 4px; border: none; background: #292929; color: #fff;"
    />

    <!-- Drills table -->
    <table id="drill-table" style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th data-column="name" style="cursor: pointer; text-align: left; padding: 0.75rem; border-bottom: 1px solid #444;">Drill Name</th>
          <th data-column="category" style="cursor: pointer; text-align: left; padding: 0.75rem; border-bottom: 1px solid #444;">Category</th>
          <th data-column="difficulty" style="cursor: pointer; text-align: left; padding: 0.75rem; border-bottom: 1px solid #444;">Difficulty</th>
          <th data-column="description" style="text-align: left; padding: 0.75rem; border-bottom: 1px solid #444;">Description</th>
        </tr>
      </thead>
      <tbody>
        <!-- Rows will be populated dynamically by JavaScript -->
      </tbody>
    </table>
  </main>

  <!-- SITE FOOTER -->
  <footer class="site-footer">
    © 2025 Defy Elite Athletics
  </footer>

  <!-- SCRIPT: load drills data from JSON and handle search/sort -->
  <script>
    async function loadDrills() {
      try {
        const res = await fetch('drills.json');
        if (!res.ok) throw new Error('Failed to load drills.json');
        const drills = await res.json();
        populateTable(drills);
      } catch (err) {
        console.error(err);
        const tbody = document.querySelector('#drill-table tbody');
        tbody.innerHTML = '<tr><td colspan="4" style="padding: 1rem; color: #ff4141;">Unable to load drills data.</td></tr>';
      }
    }

    function populateTable(drills) {
      const tbody = document.querySelector('#drill-table tbody');
      tbody.innerHTML = '';
      drills.forEach(drill => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td style="padding: 0.75rem; border-bottom: 1px solid #333;">${drill.name}</td>
          <td style="padding: 0.75rem; border-bottom: 1px solid #333;">${drill.category}</td>
          <td style="padding: 0.75rem; border-bottom: 1px solid #333;">${drill.difficulty}</td>
          <td style="padding: 0.75rem; border-bottom: 1px solid #333;">${drill.description}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Sort functionality
    function sortTable(column, ascending) {
      const table = document.getElementById('drill-table');
      const rowsArray = Array.from(table.querySelectorAll('tbody tr'));
      rowsArray.sort((a, b) => {
        const aText = a.querySelector(`td:nth-child(${column + 1})`).textContent.toLowerCase();
        const bText = b.querySelector(`td:nth-child(${column + 1})`).textContent.toLowerCase();
        if (aText < bText) return ascending ? -1 : 1;
        if (aText > bText) return ascending ? 1 : -1;
        return 0;
      });
      rowsArray.forEach(row => table.querySelector('tbody').appendChild(row));
    }

    document.querySelectorAll('#drill-table th').forEach((th, index) => {
      let ascending = true;
      th.addEventListener('click', () => {
        sortTable(index, ascending);
        ascending = !ascending;
      });
    });

    // Search/filter functionality
    document.getElementById('drill-search').addEventListener('input', function(e) {
      const filter = e.target.value.toLowerCase();
      document.querySelectorAll('#drill-table tbody tr').forEach(row => {
        const rowText = row.textContent.toLowerCase();
        row.style.display = rowText.includes(filter) ? '' : 'none';
      });
    });

    // On page load, fetch and display drills
    loadDrills();
  </script>
</body>
</html>
